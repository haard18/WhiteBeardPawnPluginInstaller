# ğŸªŸ Building on Windows VPS - Complete Guide

## ğŸ“‹ Overview

You're on Mac developing â†’ Need to build on Windows VPS â†’ Create .msi installer

## ğŸ¯ Quick Answer

**YES, just copy the entire project to Windows and run `build.bat`!**

But first, make sure you have the right files ready.

---

## ğŸ“¦ STEP 1: Prepare Files on Mac (Before Transfer)

### âœ… Files You MUST Replace (Placeholders â†’ Real Files)

```bash
cd /Users/hardy/Developer/Goldpesa/WhiteBeardPawnPluginInstaller
```

Replace these placeholders with your actual files:

1. **Plugin DLL:**
   ```bash
   # Replace: Files/PawnPlugin64.dll
   # With your actual compiled 64-bit plugin
   cp /path/to/your/actual/PawnPlugin64.dll Files/
   ```

2. **License Agreement PDF:**
   ```bash
   # Replace: Files/LicenseAgreement.pdf
   # With your actual EULA document
   cp /path/to/your/LicenseAgreement.pdf Files/
   ```

3. **User Guide PDF:**
   ```bash
   # Replace: Files/PawnPlugin_UserGuide.pdf
   # With your actual user guide
   cp /path/to/your/UserGuide.pdf Files/
   ```

4. **Icon File:**
   ```bash
   # Replace: icon.ico
   # With your actual Windows icon file (256x256 recommended)
   cp /path/to/your/icon.ico .
   ```

### âœ… Files That Are Already Ready

- âœ… `PublicKey.xml` - Already generated by LicenseGenerator
- âœ… All `.wxs` files - WiX source files
- âœ… All `.cs` files - Custom Actions source
- âœ… `build.bat` - Build script

### âš ï¸ Files You Should NOT Copy

- âŒ `LicenseGenerator/PrivateKey.xml` - Keep this SECRET on your Mac!
- âŒ `LicenseGenerator/bin/` and `LicenseGenerator/obj/` - Build artifacts
- âŒ `.git/` folder - Not needed for building
- âŒ `*.lic` license files - Not needed in installer (customers bring their own)

---

## ğŸ“¤ STEP 2: Transfer Project to Windows VPS

### Option A: Using Git (Recommended)

```bash
# On Mac - commit and push (PrivateKey.xml is already in .gitignore)
cd /Users/hardy/Developer/Goldpesa/WhiteBeardPawnPluginInstaller
git add .
git commit -m "Ready for Windows build"
git push

# On Windows - clone
git clone <your-repo-url> WhiteBeardPawnPluginInstaller
cd WhiteBeardPawnPluginInstaller
```

### Option B: Using SCP (Direct Transfer)

```bash
# On Mac - compress and upload
cd /Users/hardy/Developer/Goldpesa
tar -czf WhiteBeardPawnPluginInstaller.tar.gz \
    --exclude='.git' \
    --exclude='LicenseGenerator/bin' \
    --exclude='LicenseGenerator/obj' \
    --exclude='LicenseGenerator/PrivateKey.xml' \
    --exclude='CustomActions/bin' \
    --exclude='CustomActions/obj' \
    --exclude='*.lic' \
    WhiteBeardPawnPluginInstaller/

# Upload to Windows VPS
scp WhiteBeardPawnPluginInstaller.tar.gz user@your-windows-vps:/path/to/destination/
```

### Option C: Using FTP/SFTP Client

Use FileZilla, WinSCP, or similar:
1. Connect to your Windows VPS
2. Upload the entire `WhiteBeardPawnPluginInstaller` folder
3. Exclude: `.git`, `bin`, `obj`, `PrivateKey.xml`, `*.lic` files

### Option D: Using Cloud Storage (Easiest)

```bash
# On Mac
cd /Users/hardy/Developer/Goldpesa
zip -r WhiteBeardPawnPluginInstaller.zip WhiteBeardPawnPluginInstaller \
    -x "*.git*" \
    -x "*PrivateKey.xml" \
    -x "*.lic" \
    -x "*/bin/*" \
    -x "*/obj/*"

# Upload to Dropbox/Google Drive/OneDrive
# Download on Windows VPS
# Extract the zip
```

---

## ğŸªŸ STEP 3: Setup Windows VPS

Connect to your Windows VPS (RDP or SSH) and install prerequisites:

### A. Install .NET SDK

1. Download from: https://dotnet.microsoft.com/download
2. Install .NET 6.0 SDK (or later)
3. Install .NET Framework 4.8 Developer Pack

Verify:
```cmd
dotnet --version
```

### B. Install WiX Toolset v4

1. Download from: https://wixtoolset.org/
2. Install WiX Toolset v4.x
3. Restart your terminal/command prompt

Verify:
```cmd
wix --version
```

Should show: `wix version 4.x.x`

### C. (Optional) Install Visual Studio

Only if you want IDE support:
- Download Visual Studio 2022 Community (free)
- Install with ".NET desktop development" workload
- Install "WiX Toolset Visual Studio Extension"

---

## ğŸš€ STEP 4: Build the Installer

Open Command Prompt or PowerShell on Windows VPS:

```cmd
cd C:\path\to\WhiteBeardPawnPluginInstaller
```

### Option A: Easy Way - Use build.bat

```cmd
build.bat
```

That's it! The script will:
1. âœ… Build CustomActions.dll
2. âœ… Compile WiX source files
3. âœ… Create WhiteBeardPawnPlugin.msi

### Option B: Manual Step-by-Step

If you want to do it manually:

```cmd
REM Step 1: Build Custom Actions
cd CustomActions
dotnet restore
dotnet build -c Release
cd ..

REM Step 2: Compile WiX source
wix build Product.wxs UI\VerifyLicenseDialog.wxs UI\TermsDialog.wxs UI\MT5PathDialog.wxs ^
    -ext WixToolset.Util.wixext ^
    -ext WixToolset.UI.wixext ^
    -out WhiteBeardPawnPlugin.msi

REM Done!
```

---

## âœ… STEP 5: Verify the Build

### Check if MSI was created:

```cmd
dir WhiteBeardPawnPlugin.msi
```

You should see the file with size > 1 MB

### Test the installer:

```cmd
REM Install with verbose logging
msiexec /i WhiteBeardPawnPlugin.msi /l*v install.log

REM After testing, uninstall
msiexec /x WhiteBeardPawnPlugin.msi
```

### Check the log:

```cmd
notepad install.log
```

Search for:
- "License verified successfully" âœ…
- "MetaTrader 5 found" âœ…
- Any "ERROR" messages âŒ

---

## ğŸ“¥ STEP 6: Download the MSI

After successful build, download the MSI to your Mac:

### Option A: SCP (from Mac)

```bash
# On Mac
scp user@windows-vps:/path/to/WhiteBeardPawnPluginInstaller/WhiteBeardPawnPlugin.msi ~/Downloads/
```

### Option B: Cloud Storage

On Windows:
1. Upload `WhiteBeardPawnPlugin.msi` to Dropbox/Google Drive
2. Download on Mac

### Option C: Direct Download

If Windows VPS has a web server:
1. Copy MSI to web directory
2. Download via browser

---

## ğŸ“‹ Checklist: Files to Transfer to Windows

### âœ… Required Files:

```
WhiteBeardPawnPluginInstaller/
â”œâ”€â”€ Files/
â”‚   â”œâ”€â”€ PawnPlugin64.dll              âœ… MUST be real file
â”‚   â”œâ”€â”€ LicenseAgreement.pdf          âœ… MUST be real file
â”‚   â”œâ”€â”€ PawnPlugin_UserGuide.pdf      âœ… MUST be real file
â”‚   â””â”€â”€ (no .lic files needed)
â”œâ”€â”€ CustomActions/
â”‚   â”œâ”€â”€ *.cs                          âœ… All source files
â”‚   â””â”€â”€ CustomActions.csproj          âœ… Project file
â”œâ”€â”€ UI/
â”‚   â””â”€â”€ *.wxs                         âœ… All dialog files
â”œâ”€â”€ Product.wxs                       âœ… Main product file
â”œâ”€â”€ PluginFiles.wxs                   âœ… Component file
â”œâ”€â”€ PublicKey.xml                     âœ… Generated on Mac
â”œâ”€â”€ icon.ico                          âœ… MUST be real icon
â”œâ”€â”€ build.bat                         âœ… Build script
â”œâ”€â”€ WhiteBeardPawnPlugin.sln          âœ… Solution file
â””â”€â”€ WhiteBeardPawnPlugin.wixproj      âœ… Project file
```

### âŒ Do NOT Transfer:

```
âŒ LicenseGenerator/PrivateKey.xml    (Keep SECRET on Mac!)
âŒ LicenseGenerator/bin/               (Build artifacts)
âŒ LicenseGenerator/obj/               (Build artifacts)
âŒ CustomActions/bin/                  (Build artifacts)
âŒ CustomActions/obj/                  (Build artifacts)
âŒ Files/*.lic                         (License files - not needed)
âŒ .git/                               (Git folder)
âŒ *.msi                               (Old builds)
âŒ *.wixpdb                            (Debug files)
```

---

## ğŸ› Troubleshooting

### Error: "WiX not found"

```cmd
REM Check if WiX is installed
wix --version

REM If not found, reinstall WiX Toolset v4
REM Then restart command prompt
```

### Error: "dotnet not found"

```cmd
REM Check if .NET is installed
dotnet --version

REM If not found, install .NET SDK from Microsoft
```

### Error: "CustomActions.dll not found"

```cmd
REM Build CustomActions first
cd CustomActions
dotnet build -c Release
cd ..
```

### Error: "File not found: PawnPlugin64.dll"

```cmd
REM You forgot to replace placeholder files!
REM Copy real files to Files/ directory
```

### Error: "PublicKey.xml not found"

```cmd
REM PublicKey.xml must be in project root
dir PublicKey.xml

REM If missing, copy from Mac (it was generated by LicenseGenerator)
```

---

## ğŸ¯ Quick Reference

### Complete Build Process:

```cmd
REM 1. Navigate to project
cd C:\WhiteBeardPawnPluginInstaller

REM 2. Build
build.bat

REM 3. Test
msiexec /i WhiteBeardPawnPlugin.msi /l*v install.log

REM 4. Verify
notepad install.log

REM 5. Uninstall
msiexec /x WhiteBeardPawnPlugin.msi
```

### Build Output Files:

```
WhiteBeardPawnPlugin.msi       â† This is what you distribute!
install.log                    â† Test installation log
CustomActions/bin/Release/     â† Built DLL
```

---

## ğŸ“¤ After Building

1. **Sign the MSI** (recommended for production):
   ```cmd
   signtool sign /f YourCertificate.pfx /p password WhiteBeardPawnPlugin.msi
   ```

2. **Test on clean Windows VM** (highly recommended)

3. **Upload to your website** for distribution

4. **Update download links** in your documentation

---

## ğŸ”„ Workflow Summary

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MAC                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Develop code                                             â”‚
â”‚ 2. Generate licenses (with LicenseGenerator)               â”‚
â”‚ 3. Replace placeholder files with real files               â”‚
â”‚ 4. Transfer to Windows VPS                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WINDOWS VPS                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Receive project files                                    â”‚
â”‚ 2. Install prerequisites (WiX, .NET)                        â”‚
â”‚ 3. Run: build.bat                                           â”‚
â”‚ 4. Test: msiexec /i WhiteBeardPawnPlugin.msi               â”‚
â”‚ 5. Download MSI back to Mac or upload to web server        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DISTRIBUTION                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Upload MSI to website                                    â”‚
â”‚ 2. Customers download installer                             â”‚
â”‚ 3. Customers receive .lic files from you via email         â”‚
â”‚ 4. Customers install                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ Pro Tips

1. **Use Git**: Easiest way to sync between Mac and Windows
2. **Keep PrivateKey.xml on Mac**: Never transfer to Windows
3. **Test in VM**: Always test on clean Windows before releasing
4. **Automate**: Set up CI/CD (GitHub Actions, Azure DevOps) for automated builds
5. **Version Control**: Tag releases in git (`git tag v1.0.0`)

---

## ğŸ†˜ Need Help?

If you encounter issues:

1. Check `install.log` for error messages
2. Verify all prerequisites are installed
3. Make sure placeholder files were replaced
4. Check `BUILD.md` for detailed troubleshooting
5. Review error messages in command prompt

---

## ğŸ‰ Success!

When you see:
```
[5/5] Build complete!
========================================
Output: WhiteBeardPawnPlugin.msi
========================================
```

You're done! ğŸŠ

The MSI is ready to distribute to customers.
