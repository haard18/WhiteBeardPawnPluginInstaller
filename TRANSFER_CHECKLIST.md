# ✅ Pre-Transfer Checklist for Windows Build

## Before Copying to Windows VPS

### 1. Replace Placeholder Files

- [ ] **PawnPlugin64.dll** - Replace with your actual compiled plugin
  ```bash
  cp /path/to/real/PawnPlugin64.dll Files/
  ```

- [ ] **LicenseAgreement.pdf** - Replace with your actual EULA
  ```bash
  cp /path/to/real/LicenseAgreement.pdf Files/
  ```

- [ ] **PawnPlugin_UserGuide.pdf** - Replace with your actual user guide
  ```bash
  cp /path/to/real/UserGuide.pdf Files/
  ```

- [ ] **icon.ico** - Replace with your actual Windows icon (256x256)
  ```bash
  cp /path/to/real/icon.ico .
  ```

### 2. Verify Generated Files

- [ ] **PublicKey.xml** exists in project root
  ```bash
  ls -la PublicKey.xml
  ```

- [ ] **PrivateKey.xml** is in .gitignore (should NOT be transferred)
  ```bash
  cat .gitignore | grep PrivateKey
  ```

### 3. Update Product Information (Optional)

- [ ] Edit `Product.wxs` - Update company URLs, support email
- [ ] Edit `Product.wxs` - Generate new UpgradeCode GUID (keep it for all versions)
- [ ] Edit `Product.wxs` - Set version number

### 4. Clean Build Artifacts (Optional)

```bash
# Remove build artifacts before transfer
rm -rf CustomActions/bin CustomActions/obj
rm -rf LicenseGenerator/bin LicenseGenerator/obj
rm -f *.msi *.wixpdb
```

### 5. Transfer to Windows

Choose one method:

#### Option A: Git (Recommended)
```bash
git add .
git commit -m "Ready for Windows build"
git push
# Then clone on Windows
```

#### Option B: Zip and Upload
```bash
cd ..
zip -r WhiteBeardPawnPluginInstaller.zip WhiteBeardPawnPluginInstaller \
    -x "*.git*" -x "*PrivateKey.xml" -x "*.lic" -x "*/bin/*" -x "*/obj/*"
# Upload to Windows VPS
```

---

## On Windows VPS

### 1. Install Prerequisites

- [ ] Install .NET SDK 6.0 or later
  - Download: https://dotnet.microsoft.com/download
  - Verify: `dotnet --version`

- [ ] Install .NET Framework 4.8 Developer Pack
  - Download: https://dotnet.microsoft.com/download/dotnet-framework

- [ ] Install WiX Toolset v4
  - Download: https://wixtoolset.org/
  - Verify: `wix --version`

### 2. Build

```cmd
cd C:\path\to\WhiteBeardPawnPluginInstaller
build.bat
```

### 3. Verify

- [ ] Check if `WhiteBeardPawnPlugin.msi` was created
- [ ] File size is > 1 MB

### 4. Test Install

```cmd
msiexec /i WhiteBeardPawnPlugin.msi /l*v install.log
```

- [ ] Installation completes successfully
- [ ] Check `install.log` for "License verified successfully"
- [ ] Check `install.log` for no ERROR messages

### 5. Uninstall (After Testing)

```cmd
msiexec /x WhiteBeardPawnPlugin.msi
```

---

## Distribution

- [ ] Download MSI from Windows VPS to Mac
- [ ] Upload MSI to your website/distribution server
- [ ] Update download links in documentation
- [ ] (Optional) Code sign the MSI
- [ ] Test on clean Windows VM before releasing

---

## Quick Commands Reference

### Mac - Prepare
```bash
cd /Users/hardy/Developer/Goldpesa/WhiteBeardPawnPluginInstaller
# Replace placeholder files
# Verify PublicKey.xml exists
# Commit and push OR create zip
```

### Windows - Build
```cmd
cd C:\WhiteBeardPawnPluginInstaller
build.bat
```

### Windows - Test
```cmd
msiexec /i WhiteBeardPawnPlugin.msi /l*v install.log
notepad install.log
msiexec /x WhiteBeardPawnPlugin.msi
```

---

## Files That MUST Be Real (Not Placeholders)

❌ **Do not transfer with placeholder content:**
- Files/PawnPlugin64.dll
- Files/LicenseAgreement.pdf  
- Files/PawnPlugin_UserGuide.pdf
- icon.ico

✅ **These are ready to transfer:**
- PublicKey.xml (generated by LicenseGenerator)
- All .wxs files (WiX source)
- All .cs files (Custom Actions source)
- build.bat (build script)

🚫 **Never transfer:**
- LicenseGenerator/PrivateKey.xml (KEEP SECRET!)
- *.lic files (not needed in installer)
- bin/ and obj/ folders

---

## Success Indicators

✅ On Windows, you should see:
```
[5/5] Build complete!
Output: WhiteBeardPawnPlugin.msi
```

✅ MSI file should exist and be > 1 MB

✅ Test install should show in log:
- "License verified successfully"
- "MetaTrader 5 found" (if MT5 installed) or prompt for path
- "Installation completed successfully"

---

**Next:** See `WINDOWS_BUILD_GUIDE.md` for detailed step-by-step instructions.
